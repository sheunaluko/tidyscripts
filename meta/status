Currently working on cortex (inside apps/ts_next_app/app/laboratory/cortex_0) 

== CORTEX JS EXEC ENV UPGRADE == 
Ok getting lots of bugs - inconsistent functionality.
Want to retain existing architecture //archive it -- and shift to a different model
? DSL for the ai to write DSL code that orchestrates the available functions
--> or for ultimately flexibility -> why not just give it a javascript sandbox (using QuickJS in the browser??)


Todo

[ ] test the initialization flow

[ ] SPEC // ARCH [x]
--> realized that defining the enitre shape of the application from event based modeling of user interaction with built in telemetry to database storage and verification of telemetry data using SIMULATED user interaction event
streams. This is the target. Either requires playwright OR -- an architecture that is runnable on server side
--> workflow: AI doesnt not write any code -- instead models the UI events that occur , the app states , key function INPUTS/OUTPUTS
    	      - ARCH is a system for specifying all of this and actually "type checking" it with dummy data and dummy events , all the way to generating "fake" UI flows (actually reflected in the UI and telemetry data on a "fake")
	      	backend
	      - ARCH utilizes PARAMETERS which are included as part of the telemetry data
	      	  - a parameter is ANYTHING WHICH CAN BE OPTIMIZED VIA THE arch feedback loop
		  - also a parameter should persist despite changes to the code implementation (unless even particular implementations are considered different parameters, which would allow the AI to optimizing the
		    actual CODE for the application within the loop as well -- which seems necessary actually) 
	      - the loop is closed when analysis on the telemetry workflow data leads to proposed parameter changes (this could even include prompts, configs, etc, ?Code) , and then re-running the app 

[ ] reflect on cortex_improvements.txt, which cortex just said to me ! wtf bro
  - this actually ties in to this:
   [ ] OBSERVABILITY interface for CORTEX SESSIONS (logged in user, etc) and RAI  


[ ] user scoped RELATION architecture -- ?

[ ] add delay from when the VAD cancels speech detection to when listening is triggered , so the user says STOP , verifies pause, then states query
[ ] improve the ability to detect the first couple of words in SR 
[ ] unable to resize grid widget to 1 width

[ ] make the HTML window aware of dark mode vs light mode , or just generate theme neutral content
  - [ ] i want to think more about the HTML widget , since it is proving to be WAAAAAY more impressive and useful than i thought it would be.
  - [ ] this is a signal that i want to tune into 

[x] bootstrap call chains that exist -> this was a very exciting and interesting process! lol wish I had recorded it


[x] still trying to fix the dynamic function calls -- the architecture is overly complex at this point
due to membrane funcitonality. Although it seems i am close to have it working without errors im getting nothing save to db although it looks like something is saved to db --- confusing! 
    -> this bug was due to the access db function itself which had conflicting documentation and was expecting variables to be merged into params as apposed to {variables, query} 
[x] implemented iframe executation with configurable contex
[x] re-architect cortex to use the JS exec env (sandbox.ts)
[x] fix the get_user_input function  (also should fire event? to be displayed in UI
[x] fix the return values of the functions (dont need the @ pattern from the embedding computation anymore
[x] improve the thoughts UI with a brain emoji to start the line of each thought
[x] dynamic function calling needs to be more debuggable - for example the run_dfn needs
to actually RETURN a result as well as an error etc -- right now just seeing nothing,
including no ersult in the database 
[x] add widget that enables paging through JS exec history (see prior code, fn calls)
[x] default speed 1.5

--- 

[x] when function returns, should ?CAPTURE its value and append it to the function call U
[x] need to rearchitect the call chain templates system  (need to bootstrap the


[ ] create voice interface to claude code 
[ ] Also check out PLAYRIGHT MCP server 






== CORTEX == 
[x] Implemented matrix
[x] Need to integrate matrix with cortex
[x] -> completed the integration, and upgraded the responses api. however I am getting formatting errors (trying $0 within the string). I want to explore methods to remove this (by using official openai tool call for structure, vs first trying gemini or claude models)
    -> I tried gemini and claude - claude unable to do proper calls. Gemini did amazing and blew me away.
    -> [x] now using gemini and made lots of progress (able to store logs, search logs -- all from ccts generated by cortex as well)

[x ] discovered open source VAD lib based on silero
  -> [x] implementing voice_interface in http://localhost:8000/laboratory/component_viewer
  -> [x] implemented silero 


[x] change status popup to a widget that can be positioned
[x] move audio visualization to center of dashbar 
[x] update html widget (need to trigger automatic re-render, only changing when the full sc
[x] fix background of audio viz (toolbar not responding to dark / light mode and not passing it to  the audio viz




== FIREBASE ==

[ ] Migrate firebase functions to newer version and to parameterized env vars (prevents deploy with missing vars)

== RAI == 
Todo:
- now will shift gears to improving the voice and observability interface

- [ ] observability 
- [ ] transfer local storage to LOGIN (or allow user to toggle) ??
      --> seems it would be great to have a lib that supports a unified interface ? 


- [x] EXPAND THE CONDITIONAL LOGIC TO INCLUDE THREE POSIBILITYs, true/false/missing
- [x] before the template is processed, any text including and after  "@END_TEMPLATE" shouuld be discarded 



Completed:
- [x] legend for the dot phrases that shows next to the voice box
- [x]  NEED TO AUTOFORMAT the text box grammatically (use a fast AI model)
- [x] dot phrase should have Title  and Description  (Description shows first) ] (DONT BREAK
EXIStiNG dot phrases)
- [x] alphabetically sort the dot phrases
- [x] CLick on dot phrase to EDIT it (remove the edit button)
- [x] implement RAI
- [x] upgrade RAI -> persistent state on note generator  | after editing the note - if you leave and come back
- [x] get rid of default templates for good
- [x] enter after dot pharse works too


== BUGS ===

In cortex - html display widget enables injection of javascript into page :( 



Possible upgrades 
-> everytime you interact with cortex it keeps a running summary of the conversation stored into the database (run in background thread) as well as a summary of the graph updates

-> asynchronous tools that can be checked in on
-> various ways of reducing latency
-> initializing the system in a non blocking way -- or with all blocking calls in parallel
-> potentially exploring changing calling methodology for run_call_chain_template (different model?)

-> [x] try with gemini flash model -> wow works incredibly well

HOME AND LOGIN AT THE TOP